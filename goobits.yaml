# Goobits configuration for STT (Speech to Text)
# This file replaces the old setup-config.yaml and defines everything needed for the build command

# Setup fields for setup.sh
package_name: "goobits-stt"
command_name: "stt"
display_name: "STT - Speech to Text"
description: "Real-time speech-to-text transcription powered by Whisper"

# CLI generation configuration
cli_output_path: "src/stt/cli.py"
hooks_path: "src/stt/app_hooks.py"

python:
  minimum_version: "3.8"
  maximum_version: "3.13"

dependencies:
  required:
    - git
    - pipx
  optional:
    - ffmpeg  # For audio processing
    - portaudio  # For microphone input (system package)
  development:
    - ruff    # Modern Python linter and formatter
    - mypy    # Static type checker
    - black   # Code formatter
    - pytest  # Testing framework

installation:
  pypi_name: "goobits-stt"
  development_path: "."
  extras:
    python: ["audio"]
    apt: ["portaudio19-dev", "ffmpeg", "swig"]

shell_integration:
  enabled: false
  alias: "stt"

validation:
  check_api_keys: false
  check_disk_space: true
  minimum_disk_space_mb: 500

messages:
  install_success: |
    STT has been installed successfully!
    You can now use 'stt' from your terminal.

    Quick start:
      stt listen              # Record and transcribe once
      stt live                # Interactive conversation mode
      stt serve               # Start WebSocket server

  install_dev_success: |
    STT has been installed in development mode!
    ‚úÖ Your local changes will be reflected immediately - no reinstalling needed!

    Development workflow:
      - Edit code in src/stt/ directory
      - Test immediately with: stt listen
      - Run tests with: ./test.py
      - Format code with: ruff format src/stt/
      - Check types with: mypy src/stt/

    üí° No need to run ./setup.sh upgrade after code changes!

  upgrade_success: |
    STT has been upgraded successfully!
    Check out the latest features with: stt --version

  uninstall_success: |
    STT has been uninstalled.
    Thank you for using STT!

# CLI fields for cli.py generation
cli:
  name: "GOOBITS STT CLI"
  version: "1.0.1"
  display_version: true
  tagline: "Speech to Text"
  description: "Real-time speech-to-text transcription powered by Whisper"
  icon: "üé§"
  enable_recursive_help: true
  enable_help_json: true

  header_sections:
    - title: "üí° Quick Start"
      items:
        - { item: "stt listen", desc: "Record once and transcribe", style: "example" }
        - { item: "stt live", desc: "Real-time interactive transcription", style: "example" }
        - { item: "stt serve", desc: "Start transcription server", style: "example" }
        - { item: "stt models", desc: "Show available Whisper models", style: "example" }

    - title: "üîë Initial Setup"
      items:
        - { item: "1. Check status", desc: "stt status", style: "setup" }
        - { item: "2. Select model", desc: "stt config set model base", style: "setup" }
        - { item: "3. Start listening", desc: "stt listen", style: "setup" }

  footer_note: "üìö For detailed help on a command, run: [color(2)]stt [COMMAND][/color(2)] [#ff79c6]--help[/#ff79c6]"

  command_groups:
    - name: "Recording Modes"
      commands: ["listen", "live"]
    - name: "Server & Processing"
      commands: ["serve"]
    - name: "System"
      commands: ["status", "models"]
    - name: "Configuration"
      commands: ["config"]
  
  commands:
    listen:
      desc: "Record once and transcribe"
      icon: "üéôÔ∏è"
      options:
        - name: "model"
          short: "m"
          type: "str"
          desc: "Whisper model size (accuracy/performance)"
          choices: ["tiny", "base", "small", "medium", "large"]
          default: "base"
        - name: "language"
          short: "l"
          type: "str"
          desc: "Language code for transcription (e.g., en, es, fr)"
        - name: "device"
          short: "d"
          type: "str"
          desc: "Audio input device (microphone name)"
        - name: "hold-to-talk"
          type: "str"
          desc: "Hold-to-talk key (e.g., space, F8)"
        - name: "no-formatting"
          type: "bool"
          desc: "Output unformatted raw text"
          default: false
        - name: "sample-rate"
          type: "int"
          desc: "Audio sampling rate (Hz)"
          default: 16000
        - name: "json"
          type: "flag"
          desc: "Output transcription results as JSON"
        - name: "debug"
          type: "flag"
          desc: "Enable detailed debug logging"
        - name: "config"
          type: "str"
          desc: "Path to custom config file"

    live:
      desc: "Real-time interactive transcription"
      icon: "üó£Ô∏è"
      options:
        - name: "model"
          short: "m"
          type: "str"
          desc: "Whisper model size (accuracy/performance)"
          choices: ["tiny", "base", "small", "medium", "large"]
          default: "base"
        - name: "language"
          short: "l"
          type: "str"
          desc: "Language code for transcription (e.g., en, es, fr)"
        - name: "device"
          short: "d"
          type: "str"
          desc: "Audio input device (microphone name)"
        - name: "tap-to-talk"
          type: "str"
          desc: "Tap-to-talk key (e.g., F8)"
        - name: "no-formatting"
          type: "bool"
          desc: "Output unformatted raw text"
          default: false
        - name: "sample-rate"
          type: "int"
          desc: "Audio sampling rate (Hz)"
          default: 16000
        - name: "json"
          type: "flag"
          desc: "Output transcription results as JSON"
        - name: "debug"
          type: "flag"
          desc: "Enable detailed debug logging"
        - name: "config"
          type: "str"
          desc: "Path to custom config file"

    serve:
      desc: "Launch transcription server"
      icon: "üåê"
      options:
        - name: "port"
          short: "p"
          type: "int"
          desc: "Server port (default 8769)"
          default: 8769
        - name: "host"
          short: "h"
          type: "str"
          desc: "Server host address (default 0.0.0.0)"
          default: "0.0.0.0"
        - name: "debug"
          type: "flag"
          desc: "Enable detailed debug logging"
        - name: "config"
          type: "str"
          desc: "Path to custom config file"

    status:
      desc: "Check system health and device status"
      icon: "‚úÖ"
      options:
        - name: "json"
          type: "flag"
          desc: "Output transcription results as JSON"

    models:
      desc: "Show available Whisper models"
      icon: "üß†"
      options:
        - name: "json"
          type: "flag"
          desc: "Output transcription results as JSON"

    config:
      desc: "Adjust CLI settings and preferences"
      icon: "‚öôÔ∏è"
      subcommands:
        show:
          desc: "Display current configuration"
          options:
            - name: "json"
              type: "flag"
              desc: "Output transcription results as JSON"
        get:
          desc: "Retrieve configuration value"
          args:
            - name: "key"
              desc: "Configuration key"
              required: true
        set:
          desc: "Set a configuration value"
          args:
            - name: "key"
              desc: "Configuration key"
              required: true
            - name: "value"
              desc: "Configuration value"
              required: true

  config:
    rich_help_panel: true
    show_metavars_column: false
    append_metavars_help: true
    style_errors_suggestion: true
    max_width: 120